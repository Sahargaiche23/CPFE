â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                                                                              â•‘
â•‘        ğŸ›ï¸  SYSTÃˆME CNSS COOPÃ‰RATION TECHNIQUE - DÃ‰MARRAGE RAPIDE ğŸ›ï¸         â•‘
â•‘                                                                              â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“‹ PRÃ‰REQUIS
â•â•â•â•â•â•â•â•â•â•â•â•â•
âœ“ Oracle XE 21c dÃ©marrÃ© (docker start oracle-xe) âœ…
âœ“ RabbitMQ dÃ©marrÃ© (port 5672) âœ…
âœ“ Redis dÃ©marrÃ© (port 6379) âœ…
âœ“ Java 17+ installÃ©
âœ“ Maven 3.8+ installÃ©
âœ“ Docker & Docker Compose installÃ©s


ğŸš€ DÃ‰MARRAGE EN 4 Ã‰TAPES
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“Œ Ã‰TAPE 1: Initialiser la Base de DonnÃ©es Oracle (UNE SEULE FOIS)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
cd /home/sahar/Bureau/CNSS/CascadeProjects/windsurf-project
./scripts/init-oracle.sh

Cela va crÃ©er:
  â€¢ Utilisateur COPT
  â€¢ Tables (DOSSIER_COP, SALAIRE_ETRANGER, AFFILIATION, etc.)
  â€¢ SÃ©quences
  â€¢ Utilisateurs de test (admin/admin123)


ğŸ“Œ Ã‰TAPE 2: Compiler les Microservices
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
mvn clean install -DskipTests

Temps estimÃ©: 5-10 minutes


ğŸ“Œ Ã‰TAPE 3: DÃ©marrer les Services
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Option A - Automatique (Docker Compose):
  ./scripts/start-services.sh

Option B - Manuel (dÃ©veloppement):
  cd eureka-server && mvn spring-boot:run &
  cd gateway-service && mvn spring-boot:run &
  cd auth-service && mvn spring-boot:run &
  # ... etc


ğŸ“Œ Ã‰TAPE 4: Tester le Workflow
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
./scripts/test-workflow.sh


ğŸŒ URLS IMPORTANTES
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â€¢ Eureka Dashboard:    http://localhost:8761
â€¢ API Gateway:         http://localhost:8080
â€¢ RabbitMQ Management: http://localhost:15672 (guest/guest)
â€¢ Health Check:        http://localhost:8080/actuator/health


ğŸ§ª TEST RAPIDE (avec curl)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1ï¸âƒ£ Login:
curl -X POST http://localhost:8080/api/auth/login \
  -H "Content-Type: application/json" \
  -d '{"username":"admin","password":"admin123"}'

2ï¸âƒ£ CrÃ©er un Dossier:
curl -X POST http://localhost:8080/api/employer/create \
  -H "Content-Type: application/json" \
  -d '{
    "matricule": 500380,
    "cle": 54,
    "regime": "500",
    "dateDepotCnss": "2025-01-03",
    "dateEffet": "2024-03-01",
    "nomPrenom": "AHMED MOHAMED",
    "paysDetachement": "Qatar"
  }'

3ï¸âƒ£ Convertir Salaire:
curl -X POST http://localhost:8080/api/salary/convert \
  -H "Content-Type: application/json" \
  -d '{
    "matricule": 500380,
    "dernierSalaireTN": 4500,
    "nouveauSalaireEtranger": 2000,
    "devise": "EUR",
    "dateDetachement": "2024-03-01"
  }'


ğŸ“‚ ARCHITECTURE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

11 Microservices:
â”œâ”€â”€ eureka-server (8761)         â†’ Service Discovery
â”œâ”€â”€ gateway-service (8080)       â†’ API Gateway
â”œâ”€â”€ auth-service (8089)          â†’ Authentification JWT
â”œâ”€â”€ employer-service (8081)      â†’ Gestion Employeur
â”œâ”€â”€ salary-service (8082)        â†’ Conversion Salaire
â”œâ”€â”€ regime-service (8083)        â†’ DÃ©termination RÃ©gime
â”œâ”€â”€ affiliation-service (8084)   â†’ Affiliation
â”œâ”€â”€ debit-service (8085)         â†’ DÃ©bit Trimestriel
â”œâ”€â”€ payment-service (8086)       â†’ Paiements
â”œâ”€â”€ notification-service (8087)  â†’ Emails
â””â”€â”€ file-service (8088)          â†’ Gestion Fichiers


ğŸ” VÃ‰RIFIER L'Ã‰TAT
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
docker-compose ps                 # Ã‰tat des containers
docker-compose logs -f            # Logs en temps rÃ©el
curl http://localhost:8761        # Eureka
curl http://localhost:8089/auth/health  # Auth service


ğŸ›‘ ARRÃŠTER LES SERVICES
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
docker-compose down               # ArrÃªter tous les services
docker-compose down -v            # ArrÃªter + supprimer volumes


ğŸ“š DOCUMENTATION COMPLÃˆTE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
1. README.md              â†’ Vue d'ensemble
2. GUIDE_DEMARRAGE.md     â†’ Guide dÃ©taillÃ© avec exemples
3. BUILD.md               â†’ Compilation et dÃ©ploiement
4. PROJET_COMPLET.md      â†’ Architecture complÃ¨te
5. NEXT_STEPS.md          â†’ Roadmap et amÃ©liorations


ğŸ› PROBLÃˆMES COURANTS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âŒ Port dÃ©jÃ  utilisÃ©
   â†’ lsof -i :8080
   â†’ kill -9 <PID>

âŒ Oracle connection refused
   â†’ docker start oracle-xe
   â†’ Attendre 30 secondes

âŒ Eureka n'enregistre pas les services
   â†’ Attendre 1-2 minutes aprÃ¨s dÃ©marrage
   â†’ VÃ©rifier logs: docker-compose logs -f [service]


ğŸ‘¤ COMPTES DE TEST
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â€¢ admin / admin123 (ADMIN)
â€¢ agent / admin123 (AGENT_COOP_TECH)


ğŸ“ COMMANDES UTILES
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Maven
mvn clean install                 # Build complet
mvn clean install -DskipTests     # Build sans tests
cd [service] && mvn spring-boot:run  # Run un service

# Docker
docker-compose build              # Build images
docker-compose up -d              # DÃ©marrer
docker-compose down               # ArrÃªter
docker-compose logs -f [service]  # Logs

# Oracle
docker exec -it oracle-xe sqlplus COPT/copt123@XEPDB1


âœ… CHECKLIST DÃ‰MARRAGE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â–¡ Oracle XE dÃ©marrÃ©
â–¡ RabbitMQ dÃ©marrÃ©
â–¡ Redis dÃ©marrÃ©
â–¡ Base de donnÃ©es initialisÃ©e (scripts/init-oracle.sh)
â–¡ Services compilÃ©s (mvn clean install)
â–¡ Services dÃ©marrÃ©s (./scripts/start-services.sh)
â–¡ Eureka accessible (http://localhost:8761)
â–¡ Tests passÃ©s (./scripts/test-workflow.sh)


ğŸ‰ PROJET CRÃ‰Ã‰ AVEC SUCCÃˆS!
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Auteur: CNSS - Sahar Gaiche
Version: 1.0.0-SNAPSHOT
Date: DÃ©cembre 2025

Pour toute question, consulter la documentation dans le dossier.

Bon dÃ©veloppement! ğŸš€

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
