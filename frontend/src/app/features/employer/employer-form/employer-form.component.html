<app-main-layout>
  <div class="fade-in max-w-4xl mx-auto">
    <!-- Header -->
    <div class="mb-8">
      <a routerLink="/employer" class="text-cnss-primary hover:underline inline-flex items-center mb-4">
        <span class="material-icons mr-1">arrow_back</span>
        Retour à la liste
      </a>
      <h1 class="text-3xl font-bold text-cnss-dark">Nouvel Employeur</h1>
      <p class="text-gray-600 mt-2">Enregistrement d'un nouvel employeur régime 500 ou 510</p>
    </div>

    <!-- Form -->
    <form [formGroup]="employerForm" (ngSubmit)="onSubmit()" class="space-y-6">
      
      <!-- Régime Selection -->
      <div class="card">
        <h2 class="text-xl font-bold text-cnss-dark mb-6 flex items-center">
          <span class="material-icons mr-2 text-cnss-primary">category</span>
          Type de Régime
        </h2>
        <div class="grid grid-cols-2 gap-4">
          <label class="relative cursor-pointer">
            <input type="radio" formControlName="regime" value="500" class="sr-only peer">
            <div class="p-6 border-2 border-gray-300 rounded-lg peer-checked:border-cnss-primary peer-checked:bg-blue-50 transition-all">
              <div class="flex items-center justify-between mb-2">
                <span class="text-lg font-bold">Régime 500</span>
                <span class="material-icons text-blue-600">apartment</span>
              </div>
              <p class="text-sm text-gray-600">Employeurs tunisiens</p>
            </div>
          </label>
          
          <label class="relative cursor-pointer">
            <input type="radio" formControlName="regime" value="510" class="sr-only peer">
            <div class="p-6 border-2 border-gray-300 rounded-lg peer-checked:border-cnss-primary peer-checked:bg-green-50 transition-all">
              <div class="flex items-center justify-between mb-2">
                <span class="text-lg font-bold">Régime 510</span>
                <span class="material-icons text-green-600">domain</span>
              </div>
              <p class="text-sm text-gray-600">Employeurs étrangers</p>
            </div>
          </label>
        </div>
        <div *ngIf="employerForm.get('regime')?.invalid && employerForm.get('regime')?.touched" 
             class="text-red-600 text-sm mt-2">
          Veuillez sélectionner un régime
        </div>
      </div>

      <!-- Company Information -->
      <div class="card">
        <h2 class="text-xl font-bold text-cnss-dark mb-6 flex items-center">
          <span class="material-icons mr-2 text-cnss-primary">business</span>
          Informations de l'Entreprise
        </h2>
        
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <div class="md:col-span-2">
            <label class="block text-sm font-semibold text-gray-700 mb-2">
              Raison Sociale <span class="text-red-500">*</span>
            </label>
            <input type="text" formControlName="legalName" 
                   class="form-field"
                   placeholder="Nom officiel de l'entreprise">
            <div *ngIf="employerForm.get('legalName')?.invalid && employerForm.get('legalName')?.touched" 
                 class="text-red-600 text-sm mt-1">
              La raison sociale est obligatoire
            </div>
          </div>

          <div class="md:col-span-2">
            <label class="block text-sm font-semibold text-gray-700 mb-2">
              Nom Commercial <span class="text-red-500">*</span>
            </label>
            <input type="text" formControlName="tradeName" 
                   class="form-field"
                   placeholder="Nom commercial de l'entreprise">
          </div>

          <div>
            <label class="block text-sm font-semibold text-gray-700 mb-2">
              Pays <span class="text-red-500">*</span>
            </label>
            <select formControlName="country" class="form-field">
              <option value="">Sélectionner un pays</option>
              <option value="Tunisie">Tunisie</option>
              <option value="France">France</option>
              <option value="Allemagne">Allemagne</option>
              <option value="Italie">Italie</option>
              <option value="Belgique">Belgique</option>
              <option value="Suisse">Suisse</option>
              <option value="Autre">Autre</option>
            </select>
          </div>

          <div>
            <label class="block text-sm font-semibold text-gray-700 mb-2">
              Forme Juridique
            </label>
            <select formControlName="legalForm" class="form-field">
              <option value="">Sélectionner</option>
              <option value="SARL">SARL</option>
              <option value="SA">SA</option>
              <option value="SAS">SAS</option>
              <option value="SUARL">SUARL</option>
              <option value="Autre">Autre</option>
            </select>
          </div>
        </div>
      </div>

      <!-- Contact Information -->
      <div class="card">
        <h2 class="text-xl font-bold text-cnss-dark mb-6 flex items-center">
          <span class="material-icons mr-2 text-cnss-primary">contact_mail</span>
          Coordonnées
        </h2>
        
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <div class="md:col-span-2">
            <label class="block text-sm font-semibold text-gray-700 mb-2">
              Adresse <span class="text-red-500">*</span>
            </label>
            <textarea formControlName="address" rows="3"
                      class="form-field"
                      placeholder="Adresse complète"></textarea>
          </div>

          <div>
            <label class="block text-sm font-semibold text-gray-700 mb-2">
              Code Postal
            </label>
            <input type="text" formControlName="postalCode" 
                   class="form-field"
                   placeholder="Ex: 1000">
          </div>

          <div>
            <label class="block text-sm font-semibold text-gray-700 mb-2">
              Ville
            </label>
            <input type="text" formControlName="city" 
                   class="form-field"
                   placeholder="Ville">
          </div>

          <div>
            <label class="block text-sm font-semibold text-gray-700 mb-2">
              Téléphone
            </label>
            <input type="tel" formControlName="phone" 
                   class="form-field"
                   placeholder="+33 1 23 45 67 89">
          </div>

          <div>
            <label class="block text-sm font-semibold text-gray-700 mb-2">
              Email
            </label>
            <input type="email" formControlName="email" 
                   class="form-field"
                   placeholder="contact@entreprise.com">
          </div>
        </div>
      </div>

      <!-- Legal Information -->
      <div class="card">
        <h2 class="text-xl font-bold text-cnss-dark mb-6 flex items-center">
          <span class="material-icons mr-2 text-cnss-primary">gavel</span>
          Informations Légales
        </h2>
        
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <div>
            <label class="block text-sm font-semibold text-gray-700 mb-2">
              Numéro SIRET/SIREN
            </label>
            <input type="text" formControlName="taxId" 
                   class="form-field"
                   placeholder="123 456 789 00012">
          </div>

          <div>
            <label class="block text-sm font-semibold text-gray-700 mb-2">
              Date de Création
            </label>
            <input type="date" formControlName="creationDate" 
                   class="form-field">
          </div>
        </div>
      </div>

      <!-- Form Actions -->
      <div class="flex items-center justify-between pt-6 border-t">
        <button type="button" 
                routerLink="/employer"
                class="px-6 py-3 border-2 border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-all font-semibold">
          Annuler
        </button>
        
        <button type="submit" 
                [disabled]="employerForm.invalid || loading"
                class="px-8 py-3 bg-cnss-primary text-white rounded-lg hover:bg-opacity-90 transition-all font-semibold disabled:opacity-50 disabled:cursor-not-allowed flex items-center">
          <span *ngIf="loading" class="spinner-sm mr-2"></span>
          <span class="material-icons mr-2" *ngIf="!loading">save</span>
          {{ loading ? 'Enregistrement...' : 'Enregistrer' }}
        </button>
      </div>
    </form>
  </div>
</app-main-layout>
